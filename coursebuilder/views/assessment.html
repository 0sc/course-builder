{% extends 'base.html' %}

{% block subtitle %}
  {# I18N: Title of the webpage. #}
  {{ gettext('Assessment') }}
{% endblock subtitle %}

{% block top_content %}
{% endblock %}

{% block main_content %}

{% if is_read_write_course and is_course_admin %}
  <a href="dashboard?action=edit_assessment&key={{ unit_id }}"
    class="gcb-button gcb-button-action">Edit assessment</a>
{% endif %}

<div class="gcb-main">
  <div class="gcb-article">
    {% if assessment_script_src %}
      <script src="{{ assessment_script_src }}"></script>
    {% endif %}

    <script>
      assessmentXsrfToken = '{{ assessment_xsrf_token }}';
      {% if record_events %}
        gcbCanPostEvents = true;
        eventXsrfToken = '{{ event_xsrf_token }}';
      {% endif %}

      var assessmentGlobals = {};
      assessmentGlobals.isReviewForm = false;
      assessmentGlobals.grader = '{{ grader }}';
      {% if saved_answers %}
        assessmentGlobals.savedAnswers = JSON.parse("{{saved_answers | js_string}}");
      {% endif %}
    </script>

    {% if grader == 'human' %}
      <p>
        <strong>
          {# I18N: Shown to the student on the assignment page. #}
          {{ gettext('Due date for this assignment: ') }}
        </strong>
        {{ submission_due_date }}.
      </p>

      {% if matcher == 'peer' %}
        <p>
          <em>
            {# I18N: Instructions to the student for a peer-reviewed assignment. #}
            {{ gettext('You may only submit this assignment once. After you submit it, the assignment will become read-only, and you will not be able to modify your answers. The answers you submit here will be reviewed by your peers.')}}
          </em>
        </p>
      {% endif %}

      <hr>
    {% endif %}

    {% import 'readonly_assessment.html' as readonly_assessment %}

    {% if readonly_student_assessment is defined %}
      {# I18N: Header text for a previously-submitted assignment. #}
      <h3>{{ gettext('Submitted assignment') }}</h3>

      <div class="border-box">
        {{ readonly_assessment.display(readonly_student_assessment) }}
      </div>
    {% endif %}

    {% if reviews_received is defined %}
      {# I18N: Header text for the list of reviews received for an assignment. #}
      <h3>{{ gettext('Reviews received') }}</h3>

      {% for review in reviews_received %}
        <h4>Review {{ loop.index }}</h4>
        <div class="border-box">
          {{ readonly_assessment.display(review) }}
        </div>
      {% endfor %}
    {% endif %}

    <div style="width: 970px;" id="assessmentContents"></div>
  </div>
</div>

{% endblock %}
